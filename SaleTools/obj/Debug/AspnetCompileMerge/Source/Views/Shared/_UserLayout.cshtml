@using Common.Entities;
@{
    var typeList = (List<GoddsTypeTree>)ViewBag.GoddsTypeTree;
}

<!DOCTYPE html>

<html>




<head>
    <title>@ViewBag.Title</title>
    <meta charset="utf-8">
    <!-- global css -->
    <link rel="stylesheet" type="text/css" href="/Content/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/Content/css/base.css">
    <!-- 公用css -->
    <link rel="stylesheet" type="text/css" href="/Content/css/common/header/global.css?04260915">
    <link rel="stylesheet" type="text/css" href="/Content/css/common/footer/global.css?04260915">
    <style type="text/css">
        .pro_list {
            position: relative;
            width: 1200px;
            /*float:right;*/
            margin: 0 auto;
        }

            .pro_list .ctg_info {
                position: relative;
                /*border: 1px solid #eaeaea;*/
                /*border-top: 3px solid #eaeaea;*/
            }

                .pro_list .ctg_info .path {
                    height: 35px;
                    line-height: 35px;
                    background-color: #fff;
                }

                    .pro_list .ctg_info .path a {
                        margin: 0px 5px;
                        text-decoration: none;
                        font-size: 15px;
                        color: #666;
                    }

                    .pro_list .ctg_info .path .search_box {
                        float: right;
                        margin-right: 10px;
                        overflow: hidden;
                        margin-top: 5px;
                    }

                        .pro_list .ctg_info .path .search_box .text_value {
                            margin: 0;
                            padding: 0;
                            background-color: #fff;
                            height: 28px;
                            line-height: 28px;
                            width: 320px;
                            border: 1px solid #ccc;
                            border-right: none;
                            padding-left: 5px;
                            float: left;
                        }

        #C_page {
            margin-bottom: 60px !important;
        }

        .pro_list .ctg_info .path .search_box .search_btn {
            margin: 0;
            padding: 0;
            float: left;
            line-height: 28px;
            width: 70px;
            border: 1px solid #ccc;
            border-left: none;
            cursor: pointer;
        }

        .pro_list .ctg_info .category_con {
            border-bottom: 1px solid #ededed;
        }

        .pro_list .ctg_info .category_con, .pro_list .ctg_info .brand_con {
            position: relative;
            min-height: 30px;
            overflow: hidden;
            line-height: 30px;
            background-color: #fff;
        }

        .pro_list .ctg_info .category_con {
            border: 1px solid #d8d8d8;
        }

        .pro_list .ctg_info .brand_con {
            border: 1px solid #d8d8d8;
            border-top: none;
        }

            .pro_list .ctg_info .category_con h3, .pro_list .ctg_info .brand_con h3 {
                float: left;
                font-size: 15px;
                width: 90px;
                background: #f5f5f5;
                text-align: center;
                line-height: 45px;
                font-weight: normal;
                color: #656565;
            }

            .pro_list .ctg_info .category_con .list, .pro_list .ctg_info .brand_con .list {
                width: 920px;
                float: left;
                padding-right: 30px;
            }

                .pro_list .ctg_info .category_con .list a, .pro_list .ctg_info .brand_con .list a {
                    display: block;
                    float: left;
                    text-decoration: none;
                    color: #000000;
                    width: 100px;
                    height: 35px;
                    padding-left: 25px;
                    line-height: 35px;
                    font-size: 12px;
                    overflow: hidden;
                }

                .pro_list .ctg_info .brand_con .list a {
                    line-height: 30px;
                    /*font-size: 14px;*/
                }

                    .pro_list .ctg_info .category_con .list a:hover, .pro_list .ctg_info .brand_con .list a:hover {
                        /*background-color:#ff7300;*/
                        color: #c40000;
                        /*font-weight: bold;*/
                    }

        .pro_list .product_all {
            margin-top: 10px;
        }

            .pro_list .product_all .title {
                border: 1px solid #dadada;
                position: relative;
                height: 38px;
                background: #f5f5f5;
                padding: 0 10px;
            }

                .pro_list .product_all .title h3.btnClicked {
                    background-color: #c40000;
                    color: #fff;
                }

                    .pro_list .product_all .title h3.btnClicked:hover {
                        background-color: #c40000;
                        color: #fff;
                    }

                .pro_list .product_all .title h3 {
                    position: relative;
                    height: 30px;
                    line-height: 28px;
                    text-align: center;
                    font-size: 16px;
                    float: left;
                    width: 65px;
                    box-sizing: border-box;
                    margin-top: 4px;
                    font-weight: normal;
                    margin-left: -1px;
                    background-color: #fff;
                    color: #000;
                    border: 1px solid #dadada;
                    cursor: pointer;
                    z-index: 1;
                }

                    .pro_list .product_all .title h3:hover {
                        color: #c40000;
                        border: 1px solid #c40000;
                        z-index: 9;
                    }

                .pro_list .product_all .title .shop_num {
                    float: right;
                    height: 26px;
                    line-height: 26px;
                    border: 1px solid #ccc;
                    padding: 0 10px;
                    margin-top: 5px;
                    background: #fff;
                }

                .pro_list .product_all .title .next {
                    float: right;
                    height: 26px;
                    line-height: 26px;
                    border: 1px solid #ccc;
                    padding: 0 10px;
                    margin-left: 5px;
                    margin-top: 5px;
                    cursor: pointer;
                    background-color: #e9e9e9;
                }

        .pro_list .pro_content {
            width: 1250px;
            margin: 0 auto;
            overflow: hidden;
            margin-left: -20px;
        }

            .pro_list .pro_content li {
                width: 250px;
                float: left;
                margin-top: 10px;
                padding-bottom: 10px;
            }

                .pro_list .pro_content li:hover {
                    /*background-color:#f5f5f5;*/
                }

                .pro_list .pro_content li .pro_img {
                    padding: 20px;
                    width: 210px;
                    height: 210px;
                }

                    .pro_list .pro_content li .pro_img a {
                        display: table-cell;
                        width: 210px;
                        height: 210px;
                        text-align: center;
                        vertical-align: middle;
                    }

                        .pro_list .pro_content li .pro_img a img {
                            max-width: 100%;
                            max-height: 100%;
                            *width: 100%;
                            *height: 100%;
                            text-align: center;
                            -webkit-transition: -webkit-transform .5s;
                            transition: transform .5s;
                            -moz-transition: transform 5s;
                            -o-transition: transform 5s;
                            vertical-align: middle;
                        }

                            .pro_list .pro_content li .pro_img a img:hover {
                                -webkit-transform: scale(1.03);
                                -moz-transform: scale(1.03);
                                -o-transform: scale(1.03);
                            }

                .pro_list .pro_content li .sell_info,
                .pro_list .pro_content li .sell_btn {
                    padding: 5px 20px;
                }

                    .pro_list .pro_content li .sell_info .price {
                        float: left;
                        margin-left: 5px;
                        font-size: 14px;
                        line-height: 20px;
                        color: #ff7300;
                    }

                    .pro_list .pro_content li .sell_info .norms {
                        float: right;
                        margin-right: 5px;
                        font-size: 12px;
                        line-height: 20px;
                        color: black;
                        overflow: hidden;
                        width: 100px;
                        height: 20px;
                        display: block;
                        /*font-weight:bold;*/
                    }

                .pro_list .pro_content li .sell_title {
                    height: 36px;
                    line-height: 18px;
                    color: #666;
                    margin-left: 20px;
                    margin-right: 20px;
                    font-size: 14px;
                    overflow: hidden;
                }

        .J_Nostock {
            float: left;
            height: 26px;
            line-height: 26px;
            padding: 0 12px;
        }

        #C_BrandList {
            padding: 5px 0;
        }
        /* 品牌高度固定 展示更多 */
        .fixed_height {
            max-height: 70px;
        }

        #brandShowMore {
            position: absolute;
            top: 5px;
            right: 10px;
            height: 26px;
            line-height: 26px;
            border: 1px solid #ccc;
            padding: 0 24px 0 10px;
            margin-top: 5px;
            background: #fff;
        }

        .brand_con i {
            position: absolute;
            top: 17px;
            right: 17px;
            height: 16px;
            width: 14px;
            display: inline-block;
            background: url(/Content/images/index/arrow-down.png);
            background-size: contain;
            background-repeat: no-repeat;
        }

        .pro_list .pro_content li .sell_btn .item_quantity {
            position: relative;
            margin-right: 8px;
        }

            .pro_list .pro_content li .sell_btn .item_quantity,
            .pro_list .pro_content li .sell_btn .item_quantity .decrement,
            .pro_list .pro_content li .sell_btn .item_quantity .increment,
            .pro_list .pro_content li .sell_btn .item_quantity .quantity_input {
                float: left;
            }

                .pro_list .pro_content li .sell_btn .item_quantity .decrement,
                .pro_list .pro_content li .sell_btn .item_quantity .increment {
                    display: block;
                    width: 24px;
                    height: 24px;
                    line-height: 24px;
                    border: 1px solid #e2e2e2;
                    background: #fafafa;
                    text-align: center;
                    text-decoration: none;
                }

                .pro_list .pro_content li .sell_btn .item_quantity .increment {
                    margin-left: 38px;
                }

                .pro_list .pro_content li .sell_btn .item_quantity .quantity_input {
                    position: absolute;
                    width: 32px;
                    height: 18px;
                    top: 0;
                    left: 26px;
                    text-align: center;
                    border: 1px solid #e2e2e2;
                    border-left: none;
                    border-right: none;
                }

        .pro_list .pro_content li .sell_btn .J_AddCollectBtn {
            display: block;
            float: left;
            height: 26px;
            line-height: 24px;
            border: 1px solid #e2e2e2;
            color: #e62d2d;
            box-sizing: border-box;
            cursor: pointer;
            background: white;
        }

        .pro_list .pro_content li .sell_btn .add_collect_btn {
            padding: 0 12px;
        }

        .pro_list .pro_content li .sell_btn .collected_btn {
            padding: 0 10px;
        }

        .pro_list .pro_content li .sell_btn .disable {
            pointer-events: none;
            color: gray;
        }

        .pro_list .pro_content li .sell_btn .add_cart_btn {
            display: block;
            float: left;
            height: 26px;
            line-height: 26px;
            padding: 0 12px;
            color: #ffffff;
            background: #c40000;
        }

        .pro_list .pro_content li .sell_btn .add_collect_btn {
            margin-left: 3px;
        }

        .pro_list .pro_content li .sell_btn .add_cart_btn {
            margin-right: 3px;
        }

        .title li {
            width: 100px;
            float: left;
        }

        .title ul li ul {
            display: none;
        }

        .title ul li:hover ul {
            display: block;
        }

        #price_sort_down, #price_sort_up {
            position: absolute;
        }

        #price_sort_down {
            top: 25px;
            left: -2px;
            width: 110px;
            z-index: 999;
        }

        #price_sort_up {
            top: 55px;
            left: -2px;
            width: 110px;
            z-index: 999;
        }

        .title ul {
            display: none;
        }

        .u-flyer {
            display: block;
            width: 50px;
            height: 50px;
            border-radius: 50px;
            position: fixed;
            z-index: 9999;
        }

        #msg {
            position: fixed;
            top: 70px;
            right: 0;
            z-index: 10000;
            width: 1px;
            height: 52px;
            margin-left: -125px;
            line-height: 52px;
            font-size: 20px;
            text-align: center;
            color: #fff;
            background: #E41C1C;
            display: none
        }

        .explain {
            position: fixed;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,.2);
            z-index: 99;
            top: 0;
            left: 0;
            padding-top: 10%;
            display: none;
        }

            .explain .explain_mian {
                vertical-align: middle;
                background: white;
                width: 690px;
                min-height: 140px;
                margin: 0 auto;
                font-size: 14px;
                line-height: 25px;
                position: relative;
            }

            .explain .header {
                height: 40px;
                width: 100%;
                line-height: 40px;
            }

            .explain span, .explain_mian div {
                width: 24%;
                display: inline-block;
                text-align: center;
            }

        .explain_mian .items {
            padding: 10px 0;
        }

        .explain_mian div {
        }

            .explain_mian div input {
                width: 15%;
                text-align: center;
            }

        .explain_mian a {
            font-size: 20px;
            vertical-align: middle;
            border: 1px solid #dddddd;
            background-color: #fafafa;
            width: 20px;
            display: inline-block;
            height: 20px;
            line-height: 20px;
        }

            .explain_mian a:first-child {
                margin-right: -5px;
            }

            .explain_mian a:last-child {
                margin-left: -5px;
            }

        .explain_mian .buyButton {
            height: 26px;
            line-height: 26px;
            padding: 0 12px;
            color: #ffffff;
            background: #e62d2d;
        }

        .explain .coloseButton {
            border: 1px solid gainsboro;
            -webkit-border-radius: 100%;
            -moz-border-radius: 100%;
            border-radius: 100%;
            width: 30px;
            height: 30px;
            line-height: 10px;
            position: absolute;
            top: -15px;
            right: -15px;
            font-size: 22px;
            z-index: 99;
        }

        .j_display {
            display: block;
        }
    </style>
</head>

<body>
    <div id="wraper">
        <!-- 全局顶部导航 -->
        <div class="topbar" id="topbar">
            <div class="pace"></div>
            <div class="module clearfix">
                <div class="lfloat">
                    <a href="/Home/Index" target="_blank"><span class="main_title">首页  </span></a>
                    <span class="hello">您好，</span>
                    <span class="username">@ViewBag.UserName</span>
                    <span>
                        ，欢迎来到销宝贝
                        <!-- ,客服电话:0577-86000802 -->
                    </span>
                </div>
                <div class="rfloat">
                    <ul class="clearfix">
                        <li><a href="/Home/Index">批发首页</a></li>
                        <li><a href="/Home/HomeIndex">会员中心</a></li>
                        <li><a href="/Home/ShoppingCar">购物车</a></li>
                        <li><a href="/Login/LogOut">退出</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <script type="text/javascript" src="/Content/js/lib/jquery-1.11.1.min.js"></script>
        <script>
            (function ($) {
                $.fn.snow = function (options) {
                    var $flake = $('<div id="flake" />').css({
                        'position': 'absolute',
                        'top': '-50px',
                        'z-index': '99999999'
                    }).html('&#10052;'),
                        documentHeight = $(document).height(),
                        documentWidth = $(document).width(),
                        defaults = {
                            minSize: 10,
                            maxSize: 20,
                            newOn: 2000,
                            flakeColor: "red"
                        },
                        options = $.extend({}, defaults, options);
                    var interval = setInterval(function () {
                        documentHeight = $(document).height();
                        var startPositionLeft = Math.random() * documentWidth - 100,
                            startOpacity = 0.5 + Math.random(),
                            sizeFlake = options.minSize + Math.random() * options.maxSize,
                            endPositionTop = documentHeight - options.maxSize,
                            endPositionLeft = startPositionLeft - 100 + Math.random() * 200,
                            durationFall = documentHeight * 10 + Math.random() * 5000;
                        $flake.clone().appendTo('body').css({
                            left: startPositionLeft,
                            opacity: startOpacity,
                            'font-size': sizeFlake,
                            color: options.flakeColor
                        }).animate({
                            top: endPositionTop,
                            left: endPositionLeft,
                            opacity: 0.2
                        },
                            durationFall, 'linear',
                            function () {
                                $(this).remove()
                            });
                    },
                        options.newOn);
                };
            })(jQuery);
            //    $.fn.snow({ minSize: 5, maxSize: 50, newOn: 2000, flakeColor: 'gray' });



            //鼠标跟随 留言信息窗口
            $('.remark').mousemove(function (e) {
                $(this).children('.content').show();
                $(this).children('.content').show().css({
                    "top": e.pageY + 20,
                    "left": e.pageX + 20
                })
            });
            //滑出隐藏
            $('.remark').mouseout(function () {
                $(this).children('.content').hide();
            });
            $(window).resize(function () {
                /* Act on the event */
                if (document.documentElement.clientWidth < 1200) {
                    $('#topbar').width(1200);
                } else {
                    $('#topbar').width('100%');
                }

            });
            //加载效果
            var paces = {
                pace: $('#topbar .pace'),
                timer: "",
                w: 0,
                start: function () {
                    var _this = this;
                    _this.w = 0;
                    if (_this.timer) {
                        _this.w = 0;
                        _this.pace.width(_this.w + "%");
                        clearInterval(_this.timer);
                    } else {
                        _this.timer = setInterval(function () {
                            ++_this.w;
                            _this.pace.width(_this.w + "%");
                            if (_this.w >= 55) {
                                clearInterval(_this.timer);
                            }
                        }, 0)
                    }


                },
                end: function () {
                    var _this = this;
                    _this.w = parseInt(_this.pace[0].style.width);
                    clearInterval(_this.timer);
                    _this.timer = setInterval(function () {
                        ++_this.w;
                        _this.pace.width(_this.w + "%");
                        if (_this.w >= 100) {
                            clearInterval(_this.timer);
                            var setTimer = setTimeout(function () {
                                _this.w = 0;
                                _this.pace.width(_this.w);
                                clearInterval(_this.timer);
                            }, 1000);
                            clearTimeout(clearTimeout);
                            return false
                        }
                    }, 10)
                }
            };

            /*弹框 popup*/
            function build(status, comment, id, num) {
                if (!$(".globalPopContainer").length > 0) {
                    $(document.body).append('<div class="globalPopContainer"></div>');
                }
                if (!num) {
                    num = '';
                }
                if (status == "red") {
                    var html = "<div class='popup rpopup' id='popup_" + id + "'>";
                    html += "<span>" + comment + "<i style='color:white;font-size:25px;'>" + num + "</i></span>";
                    html += "<div class='progress rprogress'></div>";
                } else {
                    var html = "<div class='popup gpopup' id='popup_" + id + "'>";
                    html += "<span>" + comment + "<i style='color:white;font-size:25px;'>" + num + "</i></span>";
                    html += "<div class='progress gprogress'></div>";
                }
                html += "<span class='closePop'>x</span>";
                html += "</div>";
                $(".globalPopContainer").prepend(html); // 追加新元素
                $("#popup_" + id).find('.progress').width($("#popup_" + id).outerWidth())
                Popup(id, $("#popup_" + id).outerWidth());
            }

            function Popup(id, popWidth) {
                $("#popup_" + id).find(".progress").animate({ width: 0 + 'px' }, 3000, function () {
                    $("#popup_" + id).animate({ right: -popWidth + 'px' }, function () {
                        $(this).remove();
                    })
                });
                $("#popup_" + id).mouseout(function () {
                    $(this).stop(true, false);
                    $(this).find(".progress").stop(true, false);
                    $(this).find(".progress").animate({ width: 0 + 'px' }, function () {
                        $(this).parent().animate({ right: -popWidth + 'px' }, function () {
                            $(this).remove();
                        })
                    })
                });
                $("#popup_" + id).mouseover(function () {
                    var proWidth = $(this).outerWidth()
                    $(this).stop(true, false);
                    $(this).find(".progress").stop(true, false);
                    $(this).animate({ right: 0 + 'px' }, function () {
                        $(this).find(".progress").animate({ width: proWidth + 'px' });
                    });
                });
                $("#popup_" + id).find(".closePop").on('click', function (event) {
                    $(this).parent().unbind("mouseover");
                    $(this).parent().unbind("mouseout");
                    $(this).siblings('.progress').animate({ width: 0 + 'px' }, function () {
                        $(this).parent().animate({ right: -popWidth + 'px' }, function () {
                            $(this).remove();
                        })
                    })
                })
            }
        </script>
            @RenderBody()

        <!-- footer -->
        <div class="footer clearfix">
<div style="position: absolute;left: 250px;top: 20px;"><a target='_blank'  href='http://idinfo.zjaic.gov.cn//bscx.do?method=lzxx&id=3303023303006000000573'><img src='http://idinfo.zjaic.gov.cn//login.do?method=createLZ&id=3303023303006000000573'/></a></div>
            <div class="content3">
                <div class="information">
                    <p class="telephone">加盟咨询热线：<i>0577-86001998</i></p>
                    <p class="linkLine">
                    </p>
                    
                    <p class="copyright">Copyright©2014-2018</p>
                </div>
                <div class="loginCode">
                    <img src="/Content/images/lg/04191204.jpg">
                </div>
            </div>
        </div>
        <script type="text/javascript" src="/Content/js/public/baiduspider.js"></script>
    </div>
    <!-- global js -->
    <script type="text/javascript" src="/Content/js/lib/jquery-1.11.1.min.js"></script>
    <script type="text/javascript">
        var DOMAIN = { "main": "pifa.yunmayi.com", "passport": "passport.pifa.yunmayi.com", "buyer": "buyer.pifa.yunmayi.com", "seller": "seller.pifa.yunmayi.com", "ajax": "ajax.pifa.yunmayi.com", "agent": "agent.pifa.yunmayi.com" };
    </script>
    <script type="text/javascript" src="/Content/js/lib/help.js"></script>
    <!-- home common js -->
    <script type="text/javascript" src="/Content/js/pages/common/header/global.js"></script>
    <script type="text/javascript" src="/Content/js/lib/jquery.fly.min.js"></script>
    <script text="text/javascript">
        $(function () {
            var curCatId = 1031;
            var curPage = 1;
            var curBrandId = 0;
            var pageSize = 30;
            var keyword = "0";
            var sort = "id";
            var is_brand_search = false;
            // 搜索
            $('#searchBtn').on('click', function () {
                keyword = $.trim($('#searchInput').val());
                ProductList();
            });

            // 页码切换
            $('#C_page').on('click', 'a', function () {
                curPage = $(this).data('page');
                $(document).scrollTop(180);
                if (curBrandId) {
                    is_brand_search = true;
                }
                ProductList();
                return false;
            });

            //页面跳转
            $("#J_List").on('focus', '.page input', function () {
                $(this).removeAttr("onblur");
            });
            $("#J_List").on('blur', '.page input', function () {
                event.preventDefault();
                curPage = parseInt($(this).val());
                $(document).scrollTop(180);
                ProductList();
                return false;
            });

            // 品牌展开更多
            $('#brandShowMore').on('click', function () {
                var tip = $.trim($(this).html());
                switch (tip) {
                    case '更多':
                        tip = '收起';
                        $('#C_BrandList').removeClass('fixed_height');
                        $('.brand_con i').css('background', 'url(/Content/images/index/arrow-up.png)');
                        $('.brand_con i').css('background-size', 'contain');
                        $('.brand_con i').css('background-repeat', 'no-repeat');
                        $('.brand_con h3').height($('#C_BrandList').height() + 10)
                        break;
                    case '收起':
                        tip = '更多';
                        $('#C_BrandList').addClass('fixed_height');
                        //$('.brand_con i').css('background', 'url(/Content/images/index/arrow-down.png)');
                        $('.brand_con i').css('background-size', 'contain');
                        $('.brand_con i').css('background-repeat', 'no-repeat');
                        $('.brand_con h3').height($('#C_BrandList').height() + 10)
                        break;
                }
                $(this).html(tip);
                return false;
            });

            // 商品加入购物相关操作
            //$("#J_List").on("click", ".J_Decrement", function () {
            //    var _input = $(this).siblings("input.J_QuantityInput");
            //    var min = parseInt(_input.data("min"));
            //    var max = parseInt(_input.data("max"));
            //    if (max < min) {
            //        build("red", "商品库存不足", "Decrement");
            //        return false;
            //    }
            //    var quantity = parseInt(_input.val());
            //    --quantity;
            //    quantity = quantity > max ? max : quantity;
            //    quantity = quantity < min ? min : quantity;
            //    _input.val(quantity);
            //});
            //$("#J_List").on("click", ".J_Increment", function () {
            //    var _input = $(this).siblings("input.J_QuantityInput");
            //    var min = parseInt(_input.data("min"));
            //    var max = parseInt(_input.data("max"));
            //    if (max < min) {
            //        build("red", "商品库存不足", "Increment");
            //        return false;
            //    }
            //    var quantity = parseInt(_input.val());
            //    ++quantity;
            //    quantity = quantity > max ? max : quantity;
            //    quantity = quantity < min ? min : quantity;
            //    _input.val(quantity);
            //});
            //$("#J_List").on("blur", ".J_QuantityInput", function () {
            //    var _this = $(this);
            //    var max = _this.data("max");
            //    var min = _this.data("min");
            //    var quantity = _this.val();
            //    quantity = quantity > max ? max : quantity;
            //    quantity = quantity < min ? min : quantity;
            //    _this.val(quantity);
            //});
            //$("#J_List").on("click", ".J_AddCartBtn", function (event) {
            //    $(".add_cart_btn").removeClass("J_AddCartBtn");
            //    var _this = $(this);
            //    var _input = _this.prev(".item_quantity").children(".J_QuantityInput");
            //    var quantity = _input.val();
            //    var limit_start_time = _this.data("start");
            //    var limit_end_time = _this.data("end");
            //    var limit_buy_num = _this.data("num");
            //    var curentTime = Date.parse(new Date()) / 1000;
            //    var productId = _this.data("id");
            //    var items = [];
            //    var html = "";
            //    $.ajax({
            //        type: 'post',
            //        dataType: 'json',
            //        url: '/cart/isPresaleItem',
            //        data: {
            //            pid: productId
            //        },
            //        success: function (res) {
            //            items = res;
            //            if (items.length != 0) {
            //                presaleShow = true;
            //                $(".explain").addClass('j_display');
            //                html += '   <ul class="explain_mian">';
            //                html += '       <li class="header">';
            //                html += '           <span>预售活动</span>';
            //                html += '           <span>商品剩余数量</span>';
            //                html += '           <span>购买数量</span>';
            //                html += '           <span>加入购物车</span>';
            //                html += '       </li>';
            //                for (var k in items) {
            //                    html += '       <li class="items">';
            //                    html += '           <span>' + items[k].title + '</span>';
            //                    html += '           <span class="amountNum">' + items[k].amount + '</span>';
            //                    html += '           <div class="presaleItems">';
            //                    html += '               <a  href="javascript:;" class="decrementPresales"> - </a>';
            //                    html += '               <input type="text" value="1" class="presaleInput" data-max=' + items[k].amount + '>';
            //                    html += '               <a  href="javascript:;" class="addPresale"> + </a>';
            //                    html += '           </div>';
            //                    html += '           <button class="buyButton addPresaleCart" data-id=' + items[k].id + ' data-product-id=' + items[k].product_id + '>进货</button>';
            //                    html += '       </li>';
            //                }
            //                html += '       <button class="coloseButton" onclick="closeExplain()"> x </button>';
            //                html += '   </ul>';
            //                $('.add_cart_btn').addClass("J_AddCartBtn");
            //                $(".explain").html(html);
            //            } else {
            //                if (limit_start_time > 0 && limit_end_time > 0) {
            //                    if (curentTime >= limit_start_time && curentTime <= limit_end_time) {
            //                        if (quantity > limit_buy_num) {
            //                            build("red", "该商品限购", productId, limit_buy_num);
            //                            return false;
            //                        }
            //                    }
            //                }
            //                if (limit_start_time == 0 && limit_end_time == 0 && limit_buy_num > 0) {
            //                    if (quantity > limit_buy_num) {
            //                        build("red", "该商品限购", productId, limit_buy_num);
            //                        return false;
            //                    }
            //                }
            //                $.ajax({
            //                    "type": "POST",
            //                    "url": "/cart/ajaxAddItemToCart",
            //                    "dataType": "json",
            //                    "data": {
            //                        "product_id": productId,
            //                        "quantity": _input.val(), //_input.val()
            //                        "is_cart": 1
            //                    },
            //                    "success": function (result) {
            //                        $('.add_cart_btn').addClass("J_AddCartBtn");
            //                        GlobalCartItemNum();
            //                        if (!result.error) {
            //                            var addcar = _this;
            //                            var img = addcar.parent().parent().parent().find('img').attr('src');
            //                            var flyer = $('<img class="u-flyer" src="' + img + '">');
            //                            var address1 = $('#C_GlobalCartItemNum_fixed');
            //                            var address2 = $('#C_GlobalCartItemNum');
            //                            var scrollTop = $(document).scrollTop();
            //                            if (scrollTop > 130) {
            //                                flyer.fly({
            //                                    start: {
            //                                        left: event.clientX,
            //                                        top: event.clientY,
            //                                    },
            //                                    end: {
            //                                        left: address1[0].offsetLeft,
            //                                        top: address1[0].offsetTop,
            //                                        width: 0,
            //                                        height: 0
            //                                    },
            //                                    onEnd: function () {
            //                                        $("#msg").show().animate({ width: '250px' }, 200).fadeOut(1000);
            //                                        this.destory();
            //                                    }
            //                                })
            //                            } else {
            //                                flyer.fly({
            //                                    start: {
            //                                        left: event.clientX,
            //                                        top: event.clientY,
            //                                    },
            //                                    end: {
            //                                        left: address2[0].offsetLeft,
            //                                        top: address2[0].offsetTop - 20,
            //                                        width: 0,
            //                                        height: 0
            //                                    },
            //                                    onEnd: function () {
            //                                        $("#msg").show().animate({ width: '250px' }, 200).fadeOut(1000);
            //                                        this.destory();
            //                                    }
            //                                })
            //                            }
            //                        } else {
            //                            build("red", result.info, productId);
            //                        }
            //                    }
            //                });
            //            }
            //        },
            //        error: function (error) {
            //            console.log(error)
            //        }
            //    });
            //    return false;
            //});
            // 收藏商品
            /* $("#J_List").on("click", ".J_AddCollectBtn", function(){
                 $.post(
                     "/product/addCollect",
                     {
                         "product_id": $(this).data("id")
                     },
                     function(result){
                         alert(result.info);
                     },
                     "json"
                 );
             });*/

            function C_Initialize() {
                //Crumb();
                //CatList();
                //Brand();
                //ProductList();
            }

            function Crumb() {
                $.ajax({
                    type: 'get',
                    url: '/product/crumb',
                    dataType: 'json',
                    data: {
                        id: curCatId
                    },
                    success: function (result) {
                        var _html = '<a href="#" class="C_cat" data-id="0">全部商品</a>';
                        if (result.length > 0) {
                            for (var k in result) {
                                _html += '&gt;<a href="#" class="C_cat" data-id="' + result[k].id + '" data-name="' + result[k].name + '">' + result[k].name + '</a>';
                            }
                        }
                        $('#C_Crumbs').html(_html);
                    },
                    error: function () { }
                });
            }


            function CatList() {
                $.ajax({
                    type: 'get',
                    url: '/product/categoryList',
                    dataType: 'json',
                    data: {
                        id: curCatId,
                        brand_id: curBrandId
                    },
                    success: function (result) {
                        var _html = '';
                        if (result.length > 0) {
                            for (var k in result) {
                                _html += '<a href="#" class="C_cat" data-id="' + result[k].id + '" data-name="' + result[k].name + '">' + result[k].name + '</a>';
                            }
                        }
                        $('#C_CatList').html(_html);
                    },
                    error: function () { }
                });
            }

            function Brand() {
                $.ajax({
                    type: 'get',
                    url: '/product/brandList',
                    dataType: 'json',
                    data: {
                        cid: curCatId
                    },
                    success: function (result) {
                        var _html = '';
                        if (result.length > 0) {
                            for (var k in result) {
                                _html += '<a href="#" class="C_brand" data-id="' + result[k].id + '" data-name="' + result[k].name + '">' + result[k].name + '</a>'
                            }
                        }
                        $('#C_BrandList').html(_html);
                        $('.brand_con h3').height($('.brand_con').height());
                        $('.category_con h3').height($('.category_con').height())
                    },
                    error: function () { }
                });
            }

            $("#J_List").on("click", ".J_AddCollectBtn", function () {
                var productId = $(this).attr("data-id");
                $("#" + productId).addClass('disable')
                if ($(this).hasClass("collected_btn")) {
                    $.post("/index/delCollect", { "pid": productId }, function (data) {
                        if (data.state) {
                            $("#" + productId).text('收藏');
                            $("#" + productId).removeClass('collected_btn');
                            $("#" + productId).addClass('add_collect_btn');
                            $("#" + productId).removeClass("disable");
                            build("green", "已取消收藏！", productId);
                        } else {
                            build("green", "失败!请重试!", productId);
                        }
                    }, 'json')
                } else {
                    $.get("/index/productFav", { "id": productId }, function (data) {
                        if (data.state) {
                            $("#" + productId).text('已收藏');
                            $("#" + productId).removeClass('add_collect_btn');
                            $("#" + productId).addClass('collected_btn');
                            $("#" + productId).removeClass("disable");
                            build("green", "收藏成功！", productId);
                        } else {
                            build("green", "失败!请重试!", productId);
                        }
                    }, 'json')
                }
            });

            function ProductList() {
                if (is_brand_search) {
                    var tmpCurId = curCatId;
                    var tmpKeyword = keyword;
                    curCatId = 0;
                    keyword = "";
                }
                $.ajax({
                    type: 'get',
                    url: '/product/ajaxSearch',
                    dataType: 'json',
                    data: {
                        cid: curCatId,
                        bid: curBrandId,
                        q: keyword,
                        page: curPage,
                        sort: sort,
                        page_size: pageSize
                    },
                    success: function (result) {
                        if (result instanceof Object) {
                            var _productListHtml = '';
                            for (var k in result.list) {
                                _productListHtml += '<li class="C_Item" data-productid="' + result.list[k].id + '">';
                                _productListHtml += '<div class="pro_img">';
                                _productListHtml += '<a href="/product/detail?id=' + result.list[k].id + '" target="_blank"><img src="http://i8.yunmayi.com' + result.list[k].pic_url + 'XXXXX!!!!!_300x300.jpg" /></a>';
                                _productListHtml += '</div>';
                                _productListHtml += '<div class="sell_title"><a href="/product/detail?id=' + result.list[k].id + '" target="_blank">' + result.list[k].title + '</a></div>';
                                _productListHtml += '<div class="sell_info clearfix">';
                                _productListHtml += '<p class="price">' + (result.list[k].sell_price / 100).toFixed(2);
                                if (result.list[k].unit != '') {
                                    _productListHtml += '/' + result.list[k].unit;
                                }
                                _productListHtml += '</p>';
                                if (result.list[k].spec != '') {
                                    _productListHtml += '<p class="norms">规格:' + result.list[k].spec + '</p>';
                                }
                                _productListHtml += '</div>';
                                _productListHtml += '<div class="sell_btn clearfix">';
                                if (!result.list[k].is_collect)
                                    _productListHtml += '<span class="J_AddCollectBtn add_collect_btn" id="' + result.list[k].id + '" data-id="' + result.list[k].id + '">收藏</span>';
                                else
                                    _productListHtml += '<span class="J_AddCollectBtn collected_btn" id="' + result.list[k].id + '" data-id="' + result.list[k].id + '">已收藏</span>';
                                _productListHtml += '<div class="rfloat">';
                                _productListHtml += '<div class="item_quantity">';
                                _productListHtml += '<a href="javascript:;" class="decrement J_Decrement">-</a>';
                                _productListHtml += '<input type="text" value="' + result.list[k].min_sold_num + '" data-min="' + result.list[k].min_sold_num + '" data-max="' + Math.max(result.list[k].stock_info.stock, result.list[k].stock_info.warehouse_stock) + '" class="quantity_input J_QuantityInput">';
                                _productListHtml += '<a href="javascript:;" class="increment J_Increment">+</a>';
                                _productListHtml += '</div>';
                                if (result.list[k].stock_info.stock < result.list[k].min_sold_num && result.list[k].stock_info.warehouse_stock < result.list[k].min_sold_num) {
                                    _productListHtml += '<span class="J_Nostock">售罄</span>';
                                } else {
                                    _productListHtml += '<a href="#" class="J_AddCartBtn add_cart_btn" data-id="' + result.list[k].id + ' data-start=' + result.list[k].limit_start_time + ' data-end=' + result.list[k].limit_end_time + ' data-num=' + result.list[k].limit_buy_num + '">进货</a>';
                                }

                                _productListHtml += '</div>';
                                //_productListHtml += '<a href="#" class="add_pro" data-productid="'+result.productList[k].productId+'">进货</a>';
                                //_productListHtml += '<div class="add_num"><span class="del_pro_num"></span><input type="text" class="pro_num" data-minnum="'+result.productList[k].minSoldNum+'" value="'+result.productList[k].minSoldNum+'" /><span class="add_pro_num"></span></div>';
                                //_productListHtml += '<a href="#" class="favorite">收藏</a>';
                                //_productListHtml += '<div class="fav" data-id="'+result.productList[k].productId+'">收藏</div>';

                                _productListHtml += '</div>';
                                _productListHtml += '</li>';
                            }
                            $('#productList').html(_productListHtml);
                            $('#totalProductNumTip').html(result.count);
                            $('#C_page').html(result.page_str);
                            if (is_brand_search) {
                                curCatId = tmpCurId;
                                keyword = tmpKeyword;
                                is_brand_search = false;
                            }
                            // addFixed()
                        } else {
                            $('#productList').html('');
                            $('#totalProductNumTip').html(0);
                            $('#C_page').html('');
                            // addFixed()
                        }
                    },
                    error: function () {
                        // addFixed()
                    }
                });
            }

            C_Initialize();
            $('.pro_list .product_all .title>h3').click(function () {
                $(this).addClass('btnClicked');
                $(this).siblings().removeClass('btnClicked')
                sort = $(this).attr('data-index');
                ProductList();
                return false;
            });
            $('#price_sort').hover(function () {
                $('.title ul').show()
            }, function () {
                $('.title ul').hide()
            });
            // //按价格从高到低
            $("#price_sort_down").on("click", function () {
                $('#price_sort').attr('data-index', 'price_down');
            });
            // //按价格从低到低
            $("#price_sort_up").on("click", function () {
                $('#price_sort').attr('data-index', 'price_up');
            });

            // function addFixed(){
            //     var screen_height=document.body.clientHeight;//body的高度
            //     var body_height=document.documentElement.clientHeight;//当前页面的高度
            //     if(screen_height<body_height){
            //        $('.product_all').css('height','500px')
            //     }
            // }
            // $(window).resize(function() {
            //     addFixed()
            // });

        });

        //关闭预售html 弹出框
        function closeExplain() {
            $('.explain').removeClass('j_display');
        }
        //预售加减数量
        $("#explain").on("click", ".decrementPresales", function () {
            var _input = $(this).siblings("input.presaleInput");
            var quantity = _input.val();
            quantity--;
            quantity = quantity > 0 ? quantity : 1;
            _input.val(quantity);
        })
            .on('click', '.addPresale', function () {
                var _input = $(this).siblings("input.presaleInput");
                var max = parseInt(_input.data("max"));
                var quantity = _input.val();
                quantity++;
                quantity = quantity > max ? max : quantity;
                _input.val(quantity);
            })
            .on('click', '.addPresaleCart', function () {
                var id = $(this).data("id");
                var productId = $(this).data("productId");
                var _input = $(this).prev(".presaleItems").children(".presaleInput");
                var quantity = _input.val();
                var _amount = $(this).siblings('.amountNum');
                $.ajax({
                    type: "post",
                    url: "/cart/addPresaleItemToCart",
                    dataType: "json",
                    data: {
                        product_id: productId,
                        quantity: quantity, //_input.val()
                        mode: 1,
                        presaleId: id
                    },
                    success: function (res) {
                        if (res.error) {
                            build("red", res.info, "pressaleError")
                        } else {
                            GlobalCartItemNum();
                            _amount.html(_amount.html() - quantity);
                            $("#msg").show().animate({ width: '250px' }, 200).fadeOut(1000);
                        }
                    },
                    error: function (error) {
                        console.log(error)
                    }
                });
            });



        (function ($, window, document, undefined) {
            //定义分页类
            function Paging(element, options) {
                this.element = element;
                //传入形参
                this.options = {
                    pageNo: options.pageNo || 1,
                    totalPage: options.totalPage,
                    totalSize: options.totalSize,
                    callback: options.callback
                };
                //根据形参初始化分页html和css代码
                this.init();
            }
            //对Paging的实例对象添加公共的属性和方法
            Paging.prototype = {
                constructor: Paging,
                init: function () {
                    this.creatHtml();
                    this.bindEvent();
                },
                creatHtml: function () {
                    var me = this;
                    var content = "";
                    var current = me.options.pageNo;
                    var total = me.options.totalPage;
                    var totalNum = me.options.totalSize;
                    content += "<a id=\"firstPage\">首页</a><a id='prePage'>上一页</a>";
                    //总页数大于6时候
                    if (total > 6) {
                        //当前页数小于5时显示省略号
                        if (current < 5) {
                            for (var i = 1; i < 6; i++) {
                                if (current == i) {
                                    content += "<a class='current'>" + i + "</a>";
                                } else {
                                    content += "<a>" + i + "</a>";
                                }
                            }
                            content += ". . .";
                            content += "<a>" + total + "</a>";
                        } else {
                            //判断页码在末尾的时候
                            if (current < total - 3) {
                                for (var i = current - 2; i < current + 3; i++) {
                                    if (current == i) {
                                        content += "<a class='current'>" + i + "</a>";
                                    } else {
                                        content += "<a>" + i + "</a>";
                                    }
                                }
                                content += ". . .";
                                content += "<a>" + total + "</a>";
                                //页码在中间部分时候	
                            } else {
                                content += "<a>1</a>";
                                content += ". . .";
                                for (var i = total - 4; i < total + 1; i++) {
                                    if (current == i) {
                                        content += "<a class='current'>" + i + "</a>";
                                    } else {
                                        content += "<a>" + i + "</a>";
                                    }
                                }
                            }
                        }
                        //页面总数小于6的时候
                    } else {
                        for (var i = 1; i < total + 1; i++) {
                            if (current == i) {
                                content += "<a class='current'>" + i + "</a>";
                            } else {
                                content += "<a>" + i + "</a>";
                            }
                        }
                    }
                    content += "<a id='nextPage'>下一页</a>";
                    content += "<a id=\"lastPage\">尾页</a>";
                    content += "<span class='totalPages'> 共<span>" + total + "</span>页 </span>";
                    content += "<span class='totalSize'> 共<span>" + totalNum + "</span>条记录 </span>";
                    me.element.html(content);
                },
                //添加页面操作事件
                bindEvent: function () {
                    var me = this;
                    me.element.off('click', 'a');
                    me.element.on('click', 'a', function () {
                        var num = $(this).html();
                        var id = $(this).attr("id");
                        if (id == "prePage") {
                            if (me.options.pageNo == 1) {
                                me.options.pageNo = 1;
                            } else {
                                me.options.pageNo = +me.options.pageNo - 1;
                            }
                        } else if (id == "nextPage") {
                            if (me.options.pageNo == me.options.totalPage) {
                                me.options.pageNo = me.options.totalPage
                            } else {
                                me.options.pageNo = +me.options.pageNo + 1;
                            }

                        } else if (id == "firstPage") {
                            me.options.pageNo = 1;
                        } else if (id == "lastPage") {
                            me.options.pageNo = me.options.totalPage;
                        } else {
                            me.options.pageNo = +num;
                        }
                        me.creatHtml();
                        if (me.options.callback) {
                            me.options.callback(me.options.pageNo);
                        }
                    });
                }
            };
            //通过jQuery对象初始化分页对象
            $.fn.paging = function (options) {
                return new Paging($(this), options);
            }
        })(jQuery, window, document);
    </script>
    <div id="qb-sougou-search" style="display: none; opacity: 0;">
        <p>搜索</p>
        <p class="last-btn">复制</p>
        <iframe src=""></iframe>
    </div>
</body>

</html>
